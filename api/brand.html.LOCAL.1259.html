<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
<div class="container-fluid" ng-controller="navCtrl">


<div ng-repeat="event in xlist|limitTo:5">
  <div itemscope itemtype="http://schema.org/EducationEvent"> 
  <!-- meta muss wahrsch. in head -> head wird in index ausgeführt weil gesamt brand in div liegt -> keine xlist in index verfügbar: Entweder ohne meta itemprop an sidebar binden oder sidebar in requesthandler vorsortieren Außerdem ISO´s prüfen-->
   <meta itemprop="startDate" content="{{event.start_date}}"/>
   <meta itemprop="endDate" content="{{event.finish_date}}"/>
   <meta itemprop="location" content="{{event.location}} ({{event.eventgarantiestatus}})"/>
   <meta itemprop="name" content="{{event.name}}"/>
   <!-- URL notwendig? (hoher Aufwand)-->
   <!-- <meta itemprop="url" content="https://www.mitsm.de/kursname" />
   <a href="https://www.mitsm.de/kursname" target="_self"></a> -->
  </div> 
</div>


<div class="row" >
   <!---- menu -->
   <div class="row" >
   <div class="col-md-12" id="container-menu" >
    <div class="tabbable" >
     <ul class="nav nav-tabs" id="navbar" >

      <li class="active">
       <a data-target="#panel-brand" ng-click="sidebarselect = 'start'" data-toggle="tab">
        <i class="fa fa-university"></i>
       </a>
      </li>
      <li ng-repeat="topic in topics">
       <a data-target="#panel-{{topic.topic_name}}" ng-click="tablesearchchange(topic.topic_name_raw)" data-toggle="tab">
         {{topic.topic_name_raw}}</a>
      </li>
      <li class="pull-right">
       <a data-toggle="tab" data-target="#panel-sonstiges" ng-click="sidebarselect = 'start'">
        sonstiges</a>
      </li>
      <li class="pull-right">
       <a data-toggle="tab" data-target="#panel-standort" ng-click="sidebarselect = 'start'">
        <i class="fa fa-location-arrow"></i> Standorte</a>
      </li>
     </ul>
  <p></p>
  </div></div></div>
  
  <!----content & sidebar-->
  <div class="row" >
    <div class="col-md-8" id="container-content" >
   
     <div class="tab-content">
      <div class="tab-pane active" id="panel-brand">
        <div ng-bind-html="brandinfo.brandDescription"></div>
        <div class="col-md-12" id="container-footer">
          <h4>{{brandinfo.brand_name}}</h4>
          <h5 ng-bind-html="brandinfo.brandDescriptionFooter"></h5>
       </div>
      </div>

      <div ng-repeat="topicpanel in topics" class="tab-pane" id="panel-{{topicpanel.topic_name}}">
       <div class="col-md-12">
       <h2>{{topicpanel.topicHeadline}}</h2>
       <div ng-bind-html="topicpanel.topicDescription"></div>
       <div ng-bind-html="topicpanel.topicImage"></div>
        <nav class="navbar navbar-default">
         <div class="container-fluid">

            <div class="panel-group" id="accordion{{topicpanel.topic_name}}" role="tablist" >
              <div class="panel panel-default"  
                ng-repeat="panelcourse in topicpanel.courseList | orderBy:'+rank'| orderBy:'+level'">
                <div class="panel-heading" role="tab" id="heading{{panelcourse.sysName}}">
                  <h3 class="panel-title">
                    <a role="button" data-toggle="collapse" data-parent="#accordion{{topicpanel.topic_name}}" 
                    href="#collapse{{panelcourse.sysName}}" aria-expanded="false" 
                    aria-controls="collapse{{panelcourse.sysName}}">
                      {{panelcourse.courseHeadline}}
                    </a>
                  </h3> 
                </div>
                <div id="collapse{{panelcourse.sysName}}"  class="panel-collapse collapse" role="tabpanel" 
                  aria-labelledby="heading{{panelcourse.sysName}}">
                  <div class="panel-body">
                    <course-panel-body ></course-panel-body>
                    
                  </div>
                </div>
              </div>
            </div>

         </div>
        </nav>
       </div>
       <div ng-bind-html="topicpanel.footer"></div>
      </div>
      

      <div class="tab-pane" id="panel-standort">
       <p>Standortbeschreibung aus EduMS und dazugehörige Termine</p>
        <div ng-repeat="loc in location">        
         <h2><font color="#660000"><b>{{loc.name}} ~ </b><span class="badge">Teilnehmerkapazität: {{loc.locationMaxPart}} Personen</span></font></h2>   
         <div  ng-bind-html="loc.description"></div>           
        <div class="progress">
         <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: {{loc.width}}%;">
        </div>
       </div>       
       </table>
       </div>       
      </div>

      <div class="tab-pane" id="panel-sonstiges">
       <div class="panel-group" id="panel-493447">
        <div class="panel panel-default">
         <div class="panel-heading">
          <a class="panel-title collapsed" data-toggle="collapse"
           data-parent="#panel-497725" href="#panel-element-9675257"><span
           class="badge">1</span> SchulungsAGB</a>
         </div>
         <div id="panel-element-9675257" class="panel-collapse collapse">
          <div class="panel-body">
           <div class="container-fluid">
            <div class="row">
             <agb></agb>
            </div>
           </div>
          </div>
         </div>
        </div>

        <div class="panel panel-default">
         <div class="panel-heading">
          <a class="panel-title collapsed" data-toggle="collapse"
           data-parent="#panel-493447" href="#panel-element-678923"><span
           class="badge">2</span> Datenschutzerklärung</a>
         </div>
         <div id="panel-element-678923" class="panel-collapse collapse">
          <div class="panel-body">
           <div class="container-fluid">
            <div class="row">
             <datenschutzerklaerung></datenschutzerklaerung>
            </div>
           </div>
          </div>
         </div>
        </div> 

        <div class="panel panel-default">
         <div class="panel-heading">
          <a class="panel-title collapsed" data-toggle="collapse"
           data-parent="#panel-493447" href="#panel-element-236342874"><span
           class="badge">3</span> Impressum</a>
         </div>
         <div id="panel-element-236342874"
          class="panel-collapse collapse">
          <div class="panel-body">
           <div class="container-fluid">
            <div class="row">
             <impressum></impressum>
            </div>
           </div>
          </div>
         </div>
        </div>

        <div class="panel-heading">
          <a class="panel-title collapsed" data-toggle="collapse"
            data-parent="#panel-493447" href="#panel-element-scripte">
          <span class="badge">4</span> verwendete scripte</a>
        </div>
        <div id="panel-element-scripte" 
        class="panel-collapse collapse">
        <div class="panel-body">
          <div class="container-fluid">
          <div class="row">
            <a href="http://getbootstrap.com">Bootstrap v3.3.6</a>
            <a href="http://angularjs.org">AngularJS v1.4.9</a>
            <a href="https://jquery.com/download/">jQuery 2.2.1</a>
            <a href="http://underscorejs.org/">Underscore 1.8.3</a>
          </div>
          </div>
        </div>
        </div>

       </div>
      </div>
     </div>
    </div>







   <div class="col-md-4 text-center" id="sidebar"> 


     <a id="modal-1" href="#modal-container-1" role="button" class="btn btn-primary btn-block" data-toggle="modal" style="margin-bottom: 15px; ">
       <i class="fa fa-arrow-circle-right"></i> Termine &amp; Anmeldung
     </a>


     <div class="tabbable" class="tab-content">
       <div class="tab-pane active" id="panel-brand-sidebar" role="tabpanel" ng-if="sidebarselect == 'start'">
        <h3 class="text-center">
         <i class="fa fa-calendar-check-o"></i> Aktuelle Termine
        </h3>
        <right-bar-course-all ng-repeat="e in nextEvents | limitTo:5"></right-bar-course-all>
       </div>

       <div ng-repeat="topic in topics">
         <div class="tab-pane" id="panel-sidebar-{{topic.topic_name}}" role="tabpanel" 
         ng-if="sidebarselect == topic.topic_name_raw">
          <right-bar-course-all ng-repeat="e in topic.eventList | limitTo:5"></right-bar-course-all>
         </div>
       </div>

     </div>
    </div>
</div></div>



 <div class="modal fade" id="modal-container-1" role="dialog" >
   <div class="modal-dialog">
     <div class="modal-content ">

       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X </button>

       <div> <!-- afterbutton -->


         <div class="modal-body" class="col-md-12">
          <div class="row">
            <div class="col-md-9"><h2>1. Terminauswahl</h2></div>
            <div class="col-md-3"><h2>2. Anmeldung</h2></div>
          </div>
           

          <div class="row">
           <div class="col-md-9">

            <div class="row">
              <div class="col-md-8" id="spacersearchbar"></div>
              <div class="col-md-4">
               <form>
                 <div class="input-group">
                   <div class="input-group-addon"><i class="fa fa-search"></i></div>
                   <input type="text" class="form-control" placeholder="search in table" ng-model="tablesearch">
                 </div> 
               </form>
              </div>
            </div>

            <table class="table table-responsive table-hover table-striped" style="width: 98%;">
            <thead>
                <th><a href="#" ng-click="sortType = 'start_date'; sortReverse = !sortReverse"><h4>Termin</h4>
                 <span ng-show="sortType == 'start_date' && !sortReverse" class="fa fa-caret-down"></span>
                 <span ng-show="sortType == 'start_date' && sortReverse" class="fa fa-caret-up"></span>
                </a></th>                
                <th><a href="#" ng-click="sortType = 'namefortable'; sortReverse = !sortReverse"><h4>Schulung</h4>
                 <span ng-show="sortType == 'namefortable' && !sortReverse" class="fa fa-caret-down"></span>
                 <span ng-show="sortType == 'namefortable' && sortReverse" class="fa fa-caret-up"></span>
                </a></th>                
                <th><a href="#" ng-click="sortType = 'internet_location_name'; sortReverse = !sortReverse"><h4>Ort</h4>
                 <span ng-show="sortType == 'internet_location_name' && !sortReverse" class="fa fa-caret-down"></span>
                 <span ng-show="sortType == 'internet_location_name' && sortReverse" class="fa fa-caret-up"></span>
                </a></th>                
                <th><a href="#" ng-click="sortType = 'price'; sortReverse = !sortReverse"><h4>Preis</h4>
                 <span ng-show="sortType == 'price' && !sortReverse" class="fa fa-caret-down"></span>
                 <span ng-show="sortType == 'price' && sortReverse" class="fa fa-caret-up"></span>
                </a></th>
                <th><a href="#" ng-click="sortType = 'price'; sortReverse = !sortReverse"><h4>inkl. Mwst.</h4>
                 <span ng-show="sortType == 'price' && !sortReverse" class="fa fa-caret-down"></span>
                 <span ng-show="sortType == 'price' && sortReverse" class="fa fa-caret-up"></span>
                </a></th>
                <th><a href="#"><h4>Auswahl</h4></a></th>
              </thead>
              <tbody>
                <tr ng-repeat="event in extendedEventlist | orderBy:sortType:sortReverse | filter:tablesearch">
                  <td>{{event.start_date | date:"dd.MM."}} - {{event.finish_date | date:"dd.MM.yy"}}</td>
                  <td>{{event.namefortable}}</td>
                  <td>{{event.internet_location_name}}</td>
                  <td>{{event.price}},-</td>               
                  <td>{{Math.round(event.price*1.19)}},-</td>               
                  <td><input type="checkbox" class="checkbox" ng-model="event.checked" name="userAgree" ng-change="reservationlistupdate(event)"><i class="fa fa-shopping-cart" aria-hidden="true"></i></td>
                </tr>
              </tbody>
          </table>



            


           </div><!-- end md9 (table) -->


          
           <div class="col-md-3">
            <h3>Ausgewählte Termine</h3>
            <form name="formReg" class="form-horizontal" novalidate>
              <div class="form-group">
                <div class="row" style="margin-top: 15px;" ng-if="rinfo.courses.length>0">
                  <h4>Ausgewählte Termine:</h4>
                  <div ng-repeat="picked in rinfo.courses track by $index">
                    <h4>{{picked.course_name}}</h4>
                    <div class="row">
                      <div class="col-md-12">
                        {{picked.internet_location_name}}, {{picked.start_date | date:"dd.MM."}} - {{picked.finish_date | date:"dd.MM.yy"}}
                      </div>
                    </div>

                    <div class="row">
                      <div class="col-md-1"><input type="checkbox" class="checkbox" ng-model="picked.checked"></div>
                      <div class="col-md-2">Kurs</div>
                      <div class="col-md-9">{{picked.price}},- €</div>
                    </div>


<!-- einer von beiden codeblöcken bleibt -->
                    <div class="row" ng-if="picked.test.price>1">
                      <div class="col-md-1"><input type="checkbox" class="checkbox" ng-model="picked.checked"></div>
                      <div class="col-md-2">Prüfung</div>
                      <div class="col-md-9">{{picked.test.price}},- €</div>
                    </div>

                    <div class="row" ng-if="picked.exam.price>1">
                      <div class="col-md-1"><input type="checkbox" class="checkbox" ng-model="picked.checked"></div>
                      <div class="col-md-2">Prüfung</div>
                      <div class="col-md-9">{{picked.exam.price}},- €</div>
                    </div>
                    
                    <div class="row" ng-if="picked.test.coursePrice>1">
                      <div class="col-md-1"><input type="checkbox" class="checkbox" ng-model="picked.checked"></div>
                      <div class="col-md-2">Prüfung</div>
                      <div class="col-md-9">{{picked.test.coursePrice}},- €</div>
                    </div>

                    <div class="row" ng-if="picked.exam.coursePrice>1">
                      <div class="col-md-1"><input type="checkbox" class="checkbox" ng-model="picked.checked"></div>
                      <div class="col-md-2">Prüfung</div>
                      <div class="col-md-9">{{picked.exam.coursePrice}},- €</div>
                    </div>
<!--  -->


                  </div>
               </div>
                <div class="row" style="margin-top: 10px; ">

                  <div class="col-md-1"> </div>

                  <div class="col-md-8" >

                  <div class="row">
                    <div class="col-md-6"><h4>Teilnehmerzahl</h4></div>
                    <div class="col-md-4" >
                      <input type="number" class="form-control" id="inputAnzahlIdModal" placeholder="1" min="1" 
                       ng-model="rinfo.mTeilnehmerZahl">
                    </div>
                                           
                     <i class="fa fa-caret-up" ng-mousedown="rinfo.mTeilnehmerZahl = rinfo.mTeilnehmerZahl +1" ></i><br>
                     <i class="fa fa-caret-down" ng-mousedown="teilnehmerZahlcountDown()" ></i>
                    
                  </div>
                  <div class="row" class="input-group" class="form-input">
                    <div>
                      <input type="email" class="form-control" style="margin-top: 10px; " id="inputEmailIdModal" 
                       placeholder="Kontakt E-Mail" ng-model="rinfo.mAdresse">
                    </div>
                  </div>
                  <div class="row">
                    <div>
                      <button type="button" class="btn btn-block" ng-model="reservate" 
                        style="margin-top: 6px;" ng-click="reservate()">
                        <i class="fa fa-caret-right" aria-hidden="true" style="color:#fff;"></i> Anmeldung
                      </button>
                    </div>
                  </div>
                  </div>
              </div>

              </div>
              </form>

           </div>

         </div><!-- end registerform -->

        </div><!-- end  -->

       </div> <!-- end afterbutton -->


        <div class="modal-footer">

          <div class="row">
            <div class="col-md-10"></div>
            <div class="col-md-1"><button type="button" class="btn btn-danger" data-dismiss="modal">schließen
            </button></div>
            <div class="col-md-1"><button type="button" class="btn btn-block" ng-click="reservate()">
              <i class="fa fa-caret-right"></i> Anmeldung</button>
            </div>
          </div>

        </div>
     </div> <!-- end modal-content -->
   </div> <!-- end modal-dialog-->
 </div> <!-- modal fade -->




<div class="modal fade" id="modal-container-2" role="dialog" class="col-md-4" >
   <div class="modal-dialog">
     <div class="modal-content ">

       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X </button>

       <div> <!-- afterbutton -->
         <div class="modal-body" >
           <after-reserve></after-reserve>    
         </div><!-- end registerform -->
       </div> <!-- end afterbutton -->


        <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">
         schließen</button>
         <button type="button" class="btn btn-success" ng-click="reservate()">
          <i class="fa fa-arrow-circle-right"></i> Anmeldung
         </button>

        </div>
     </div> <!-- end modal-content -->
   </div> <!-- end modal-dialog-->
 </div> <!-- modal fade -->
</div>
